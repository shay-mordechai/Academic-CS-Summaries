**ב.** תהי $B$ קבוצת כל קידודי השלשות $w=\langle \langle p, q \rangle, x \rangle$ עבורם שתי התכניות $p,q$ בריצתן על הקלט $x$ כבר עצרו באיזשהו רגע $t$ ומשתנה הפלט $Y$ של $p$ בזמן $t$ זהה למשתנה הפלט $Y$ של $q$ בזמן $t$.
סווג את $B$ ברמה הנמוכה ביותר בהיררכיה ר"פ/חישובית/במ"ר ולא חישובית/לא במ"ר.
הוכח את תשובתך. לא תתקבל תשובה ללא הוכחה.

---

### פתרון סעיף ב'

[cite_start]**סיווג:** הקבוצה $B$ היא **במ"ר (בת מנייה רקורסיבית) אך לא חישובית**[cite: 116].

**הוכחה (חלק 1 - $B$ היא במ"ר):**
[cite_start]נוכיח זאת על ידי הגדרת הקבוצה באמצעות **כימות לא חסום** על פרדיקט ר"פ[cite: 356].
הקבוצה $B$ מכילה שלשות $w$ שעבורן **קיים** זמן $t$ כלשהו שבו התנאי מסעיף א' מתקיים.
נחלץ את המרכיבים מ-$w$: $p=l(l(w)), q=r(l(w)), x=r(w)$.

הגדרת הקבוצה:
$$B = \{ w \mid \exists t [ STP(x, p, t) \land STP(x, q, t) \land (SNAP(x, p, t))_1 = (SNAP(x, q, t))_1 ] \}$$

הביטוי בתוך הסוגריים המרובעים הוא בדיוק הפרדיקט מסעיף א' (עבור $x, p, q, t$) שהוכחנו שהוא ר"פ.
[cite_start]לפי משפט אפיון קבוצות במ"ר[cite: 355], קבוצה המוגדרת על ידי כימות לא חסום ($\exists t$) על פרדיקט ר"פ היא קבוצה במ"ר.

**הוכחה (חלק 2 - $B$ אינה חישובית):**
[cite_start]נוכיח ש-$B$ אינה חישובית על ידי רדוקציה מהקבוצה $K$ (שהיא במ"ר אך לא חישובית)[cite: 353, 93].
נראה ש-$K \le_m B$.

נגדיר פונקציית רדוקציה $f: \mathbb{N} \to \mathbb{N}$. לכל $n$ (מועמד ל-$K$), נבנה שלשה $w_n = \langle \langle P_n, Q \rangle, 0 \rangle$ באופן הבא:

1.  **בניית תוכנית $P_n$:** התוכנית תתעלם מהקלט שלה, תריץ את $\Phi(n, n)$ (בדיקה האם $n \in K$), ואם העצירה מתרחשת, תציב $Y \leftarrow 1$.
    * קוד רעיוני ל-$P_n$:
        $Z \leftarrow \Phi(n, n)$
        $Y \leftarrow 1$
2.  **בניית תוכנית $Q$:** תוכנית קבועה שפשוט מציבה $1$ ב-$Y$ ועוצרת מיד.
    * קוד רעיוני ל-$Q$:
        $Y \leftarrow 1$

פונקציית הרדוקציה היא: $f(n) = \langle \langle \#P_n, \#Q \rangle, 0 \rangle$. הפונקציה חישובית (ניתנת לביצוע ע"י משפט הפרמטר וקידוד תוכניות).

**הוכחת תקפות הרדוקציה:**
* **אם $n \in K$:** התוכנית $\Phi(n, n)$ עוצרת. לכן התוכנית $P_n$ תעצור בסופו של דבר ותפלוט $1$. התוכנית $Q$ עוצרת תמיד ופולטת $1$. מכיוון ששתיהן עוצרות, קיים זמן $t$ (המקסימום מבין זמני הריצה שלהן) שבו שתיהן סיימו, והפלט של שתיהן הוא $1$ (זהה). לכן $\langle \langle \#P_n, \#Q \rangle, 0 \rangle \in B$, כלומר $f(n) \in B$.
* **אם $n \notin K$:** התוכנית $\Phi(n, n)$ נכנסת ללולאה אינסופית. לכן התוכנית $P_n$ לעולם לא תעצור. התנאי של הקבוצה $B$ דורש ש**שתי** התוכניות יעצרו ברגע $t$ כלשהו. מכיוון ש-$P_n$ לא עוצרת, לא קיים $t$ כזה. לכן $f(n) \notin B$.

[cite_start]הראינו $K \le_m B$. מכיוון ש-$K$ אינה חישובית, גם $B$ אינה חישובית[cite: 365].

**מסקנה סופית:** $B$ היא במ"ר לא חישובית.
מ.ש.ל.





בסעיף ב', אנחנו עוסקים בקבוצה $B$ שמוגדרת כך: $$B = { \langle \langle p, q \rangle, x \rangle \mid \exists t [ \text{programs } p, q \text{ stop on } x \text{ by time } t \text{ AND } Output_p = Output_q ] }$$

בוא ננתח את זה לאט, שלב אחר שלב, תוך התמקדות ב**למה** היא מסווגת כפי שהיא מסווגת.

### 1. הבנת הקלט: "קידודי שלשות"

הקלט לקבוצה הוא מספר יחיד, $w$. המספר הזה הוא תוצאה של פונקציית הזיווג (Pairing function) שהופעלה פעמיים באופן מקונן:

1. יש לנו שני מספרי תוכניות, $p$ ו-$q$.
2. יש לנו קלט $x$.
3. אנו יוצרים זוג $\langle p, q \rangle$.
4. אנו יוצרים זוג חדש מהתוצאה ומ-$x$: $\langle \langle p, q \rangle, x \rangle$.

מכיוון שפונקציות הזיווג ($<,>$) ופונקציות החילוץ ($l(z), r(z)$) הן **ר"פ** (רקורסיביות פרימיטיביות), אנחנו יכולים בקלות "לפרק" את $w$ חזרה למרכיבים שלו:

- $x = r(w)$
- $p = l(l(w))$
- $q = r(l(w))$

### 2. למה הקבוצה היא במ"ר (ניתנת למנייה רקורסיבית)?

קבוצה היא **במ"ר** אם ניתן לכתוב עבורה אלגוריתם ש**עוצר ומחזיר "כן"** אם הקלט שייך לקבוצה, אך עלול לרוץ לנצח אם הקלט לא שייך.

במקרה שלנו, התנאי הוא "קיים זמן $t$" ($\exists t$). זהו הרמז הגדול ביותר לכך שהקבוצה היא במ"ר. אנחנו יכולים לכתוב תוכנית "מזהה" שתעבוד כך:

1. קבל את הקלט $w$ וחלוץ את $p, q, x$.
2. התחל לולאה עם משתנה זמן $t$ שמתחיל ב-0 וגדל ב-1 בכל סיבוב ($t=0, 1, 2, ...$).
3. עבור כל $t$, בדוק:
    - האם תוכנית $p$ עצרה על $x$ תוך $t$ צעדים? (משתמשים בפרדיקט $STP(x, p, t)$ שהוא ר"פ).
    - האם תוכנית $q$ עצרה על $x$ תוך $t$ צעדים? (שוב, $STP(x, q, t)$).
    - **אם שתיהן עצרו:** חלץ את הפלט שלהן מתוך תמונת הזיכרון ($SNAP$) ובדוק אם הפלטים זהים.
4. אם התנאים התקיימו – עצור ותחזיר "אמת" (1).
5. אם לא – הגדל את $t$ והמשך לולאה.

**המסקנה:** אם הקידוד שייך ל-$B$, מובטח לנו שקיים איזשהו $t$ שבו זה יקרה, ולכן התוכנית תעצור. אם לא, נחפש לנצח. זו בדיוק ההגדרה של **במ"ר**.

פורמלית, לפי משפט האפיון: הקבוצה מוגדרת כ- ${ w \mid \exists t R(w, t) }$ כאשר $R$ הוא פרדיקט ר"פ (בדיקת ה-$STP$ והשוואת הפלטים), ולכן היא במ"ר.

### 3. למה הקבוצה אינה חישובית (לא כריעה)?

כדי להוכיח שקבוצה היא **לא חישובית**, אנחנו צריכים להראות שלא ניתן לפתור את הבעיה "שלילית" (כלומר, המכונה נתקעת אם התנאי לא מתקיים, ואי אפשר לתקן את זה). נעשה זאת על ידי **רדוקציה** מבעיית העצירה ($K$), שידועה כלא חישובית.

**המטרה:** להראות ש-$K \le_m B$. כלומר: נבנה פונקציה $f$ שלוקחת קלט $n$ (לבעיית $K$) ומחזירה שלשה $w$ (לבעיה $B$), כך ש:

- אם התוכנית $n$ עוצרת על עצמה ($n \in K$) $\rightarrow$ השלשה $f(n)$ תהיה ב-$B$.
- אם התוכנית $n$ נתקעת ($n \notin K$) $\rightarrow$ השלשה $f(n)$ לא תהיה ב-$B$.

**הבנייה (הרדוקציה):** עבור קלט $n$ (שאנו רוצים לדעת אם הוא ב-$K$), נבנה שתי תוכניות:

1. **תוכנית $P_1$ (שתלויה ב-$n$):** התוכנית הזו תתעלם מהקלט שלה ($x$), ותריץ את הבדיקה של $K$: האם התוכנית $n$ עוצרת על הקלט $n$?
    - אם $n$ עוצרת $\rightarrow$ $P_1$ תעצור ותחזיר פלט קבוע, למשל **1**.
    - אם $n$ לא עוצרת $\rightarrow$ $P_1$ תיתקע לנצח.
    - (את קוד התוכנית הזו אנו בונים בעזרת משפט הפרמטר כדי להטמיע את $n$).
2. **תוכנית $P_2$ (קבועה):** תוכנית שפשוט עוצרת מיד ומחזירה את הפלט **1**.

**הפונקציה $f(n)$:** מחזירה את הקידוד $\langle \langle #P_1, #P_2 \rangle, 0 \rangle$. (הקלט $x$ לא משנה, נבחר 0).

**בדיקת נכונות:**

- **מקרה א': $n \in K$ (התוכנית המקורית עוצרת).**
    - תוכנית $P_1$ תעצור (כי היא רק מריצה את $n$ על $n$). הפלט שלה יהיה 1.
    - תוכנית $P_2$ עוצרת תמיד והפלט שלה הוא 1.
    - **התוצאה:** שתי התוכניות עצרו, והפלט שלהן זהה (1=1). לכן $f(n) \in B$.
- **מקרה ב': $n \notin K$ (התוכנית המקורית נתקעת).**
    - תוכנית $P_1$ נכנסת ללולאה אינסופית (כי היא מחכה ל-$n$ על $n$). היא לעולם לא עוצרת.
    - התנאי של קבוצה $B$ דורש ש**שתי** התוכניות יעצרו. מכיוון ש-$P_1$ לא עוצרת, התנאי לא מתקיים.
    - **התוצאה:** $f(n) \notin B$.

**סיכום סעיף ב':** הקבוצה היא **במ"ר** (כי ניתן לזהות חיובית על ידי הרצה סימולטנית) אך **לא חישובית** (כי אם אחת התוכניות לא עוצרת, אנחנו נחכה לנצח ולא נדע אם היא "עוד רגע עוצרת" או "נתקעה לתמיד", וזה שקול לבעיית העצירה).