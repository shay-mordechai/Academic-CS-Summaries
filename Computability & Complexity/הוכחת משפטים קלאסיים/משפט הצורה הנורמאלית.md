**שאלה 4 במבחן תשע"ד (2014) מועד א'** דרשה במפורש להוכיח את **משפט הצורה הנורמלית** (המופיע לעיתים כמשפט 3.4 בחומרי הקורס).

להלן פירוט המשפט וההוכחה כפי שהם מופיעים בפתרון המבחן ובחומרי העזר:

### משפט הצורה הנורמלית (Kleene's Normal Form Theorem)

**הניסוח:** תהי $f(x_1, ..., x_n)$ פונקציה כלשהי. הפונקציה $f$ היא **חישובית חלקית** אם ורק אם קיים פרדיקט **רקורסיבי פרימיטיבי (ר"פ)** $R(x_1, ..., x_n, z)$ כך שמתקיים: $$f(x_1, ..., x_n) = l(\min_z R(x_1, ..., x_n, z))$$ לכל $x_1, ..., x_n$,.

_(הערה: הפונקציה $l(z)$ היא פונקציית הפיענוח השמאלית של זוגות, המחלצת את האיבר הראשון מתוך הקידוד $z$)_.

### הוכחת המשפט

ההוכחה מורכבת משני כיוונים,:

**כיוון ראשון ($\Leftarrow$):** אם פונקציה $f$ ניתנת לכתיבה בצורה $l(\min_z R(x_1, ..., x_n, z))$ כאשר $R$ הוא פרדיקט ר"פ, אזי $f$ היא חישובית חלקית. **הוכחה:**

1. הפרדיקט $R$ הוא ר"פ ולכן הוא **חישובי**.
2. הפונקציה $\min_z R(...)$ מתקבלת על ידי פעולת **מינימיזציה (לא חסומה)** על פרדיקט חישובי, ולכן היא פונקציה חישובית חלקית.
3. הפונקציה $l(z)$ (חילוץ זוגות) היא פונקציה **ר"פ** (ולכן חישובית).
4. הפונקציה $f$ מתקבלת על ידי **הרכבה** של פונקציות חישוביות (הפענוח $l$ על תוצאת המינימיזציה), ולכן $f$ היא חישובית חלקית.

**כיוון שני ($\Rightarrow$):** אם $f$ היא פונקציה חישובית חלקית, אזי ניתן להציגה בצורה הנורמלית. **הוכחה (הבנייה):**

1. מכיוון ש-$f$ חישובית חלקית, קיימת תוכנית $P$ בשפה $S$ המחשבת אותה. נסמן את מספר התוכנית ב-$p$, כלומר $#(P)=p$.
2. אנו מחפשים פרדיקט $R$ שיבדוק האם מספר $z$ מקודד "היסטוריית חישוב" מוצלחת שמסתיימת בפלט. נגדיר את $z$ כקידוד של זוג $\langle y, t \rangle$ (או $\langle t, y \rangle$ תלוי במימוש הספציפי), כאשר $t$ הוא מספר הצעדים ו-$y$ הוא הפלט/תמונת המצב הסופית.
3. נשתמש בשני פרדיקטים/פונקציות עזר שידוע שהם **ר"פ** (על סמך "משפט מונה הצעדים"):
    - $STP^{(n)}(x_1, ..., x_n, p, t)$: פרדיקט המקבל אמת אם התוכנית $p$ עוצרת על הקלט בתוך $t$ צעדים.
    - $SNAP^{(n)}(x_1, ..., x_n, p, t)$: פונקציה המחזירה את "תמונת המצב" (הכוללת את ערך משתנה הפלט) של התוכנית לאחר $t$ צעדים.
4. נגדיר את הפרדיקט $R(x_1, ..., x_n, z)$ כך: $$R(x_1, ..., x_n, z) \iff STP(x_1, ..., x_n, p, l(z)) \land (SNAP(x_1, ..., x_n, p, l(z)) \text{ encodes } r(z))$$ _(הסבר: $R$ בודק האם $z$ הוא זוג המורכב מזמן ריצה $l(z)$ ופלט $r(z)$, כך שהתוכנית אכן עוצרת בזמן זה והפלט שלה תואם)_.
5. מכיוון ש-$STP$ ו-$SNAP$ הם ר"פ, וגם פונקציות הפיענוח $l, r$ והשוויון הם ר"פ, הרי שגם **$R$ הוא פרדיקט ר"פ**.
6. **הערך המינימלי:** הביטוי $\min_z R(x_1, ..., x_n, z)$ יחפש את ה-$z$ הקטן ביותר (שמייצג את זמן העצירה המינימלי ואת הפלט המתאים) שעבורו התוכנית עוצרת.
7. **חילוץ הפלט:** הפעלת הפונקציה $l$ (או הפונקציה המתאימה לפלט בקידוד שנבחר) על תוצאת המינימיזציה תחזיר בדיוק את ערך הפונקציה $f(x_1, ..., x_n)$ אם היא מוגדרת (התוכנית עוצרת), ותהיה לא מוגדרת (לולאה אינסופית בחיפוש המינימום) אם $f$ לא מוגדרת,.

**לסיכום:** הראינו שניתן לייצג כל פונקציה חישובית באמצעות מינימיזציה על פרדיקט ר"פ (הבודק את תקינות החישוב) ופונקציות יסודיות.